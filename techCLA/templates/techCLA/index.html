{% extends "techCLA/base.html" %}

{% block navbar %}
<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="container">
    <!-- Navbar : Brand -->
    <a class="navbar-brand" href="{% url 'index' %}">Technology CLA</a>

    <!-- Search Bar -->
    <form class="d-flex flex-grow-1 mx-3" action="{% url 'index' %}">
      <input class="form-control w-100 me-2" type="search" placeholder="Search..." name="q" aria-label="Search">
      <button class="btn btn-outline-dark" type="submit">Search</button>
      <!-- TODO: add search functionality -->
    </form>

    <!-- Navbar : Sign in / Sign out -->
    <div class="collapse navbar-collapse justify-content-end">
      <ul class="navbar-nav">
        <li class="nav-item d-flex align-items-center">
          {% if user.is_authenticated %}
          <div class="d-flex align-items-center">
            <div class="nav-item dropdown me-3">
              <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Hello, {{ user.role }} {{ user.get_full_name|default:user.username }}
              </a>

              <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                {% if user.profile.profile_picture and "default_profile" not in user.profile.profile_picture.url %}
                    <img src="{{ user.profile.profile_picture.url }}" alt="Profile Picture" width="150">
                {% else %}
                    <p>No profile picture available.</p>
                {% endif %}
                <li><span class="dropdown-item-text"><strong>Email:</strong> {{ user.email }}</span></li>
                <li><span class="dropdown-item-text"><strong>Role:</strong> {{ user.role }}</span></li>
              </ul>
              <!--TODO: add more for visible account details?-->
            </div>
            <a href="{% url 'account_logout' %}" class="btn btn-outline-dark">Sign Out</a>
          </div>
          {% else %}
            <a href="{% url 'account_login' %}" class="nav-link">
              Hello, Sign in
            </a>
          {% endif %}
        </li>
      </ul>
    </div>
  </div>
</nav>
{% endblock %}

{% block secondNav %}
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container">
    <div class="btn-group">
      <a class="rounded-0 border-0 btn btn-outline-light">Placeholder Category</a>
      <a class="rounded-0 border-0 btn btn-outline-light">Placeholder Category</a>
    </div>

    <div class="collapse navbar-collapse justify-content-end">
      <button class="border-0 bg-transparent" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidenav">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </div>
</nav>
{% endblock %}

{% block content %}
<div class="mt-4">
  <!-- Welcome message -->
  <h2>{{ welcome }}</h2>

  <!-- Show user details -->
  {% if user.username %}
    <p class="lead">Logged in as: <strong>{{ user.username }}</strong> ({{ user.role }})</p>
  {% endif %}

  <!-- Main Content -->
  <hr>
  <div class="row">
    <div class="col-md-12">
      <h4>Our Collections</h4>
      <p>This is where you can browse our collections and items.</p>

      <div class="pb-3">
        <a href="{% url 'catalog' %}" class="rounded-0 btn btn-outline-dark">View All Collections</a>
      </div>

      <div class="row row-cols-4">
        <div class="col">
          <!-- TODO: Placeholder, fix when collections are implemented -->
          <a href="/collection/{{ collection.id }}/" class="text-decoration-none text-dark">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title">Placeholder</h5>
                <p class="card-text">placeholder</p>
              </div>
            </div>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
