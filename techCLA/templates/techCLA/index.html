{% extends "techCLA/base.html" %}

{% block content %}
<div class="mt-4">
  <!-- Welcome message -->
  <h2>{{ welcome }}</h2>

  <!-- Show user details -->
  {% if user.username %}
    <p class="lead">Logged in as: <strong>{{ user.username }}</strong> ({{ user.role }})</p>
  {% endif %}

  <!-- Main Content -->
  <hr>
  <div class="row">
    <div class="col-md-12">
      <h4>Our Collections</h4>
      <p>This is where you can browse our collections and items.</p>

      <div class="pb-3">
        <a href="{% url 'catalog' %}" class="rounded-0 btn btn-outline-dark">View All Collections</a>
      </div>

      <div class="row row-cols-1 row-cols-md-3 g-4">
        {% for collection in collections|slice:":6" %}
          <div class="col">
            <div class="card">
              <div class="card-header mt-1">
                <h5 class="card-title">
                  <a href="{% url 'collection_detail' collection.id %}" class="text-decoration-none text-dark">
                    {{ collection.name }}
                  </a>
                </h5>
              </div>
              <div class="card-body">
                <p class="card-text">{{ collection.description }}</p>
                <div class="d-flex justify-content-around px-3 pb-3 gap-3">
                  {% for item in collection.items.all|slice:":2" %}
                    <div class="text-center" style="width: 45%;">
                      <a href="{% url 'item_detail' item.title %}" class="text-decoration-none">
                        {% if item.image %}
                          <img src="{{ item.image.url }}" class="img-fluid rounded mb-2" style="max-height: 120px; object-fit: cover;" alt="{{ item.title }}">
                        {% endif %}
                        <div class="fw-semibold">{{ item.title }}</div>
                      </a>
                    </div>
                  {% endfor %}
                </div>
              </div>
              
              <div class="card-footer text-muted">
                <a href="{% url 'collection_detail' collection.id %}" class="btn btn-sm btn-outline-primary">View Collection</a>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
